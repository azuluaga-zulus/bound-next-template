# Reglas de Ingeniería — Bound
{
"meta": {
"owner": "Alejandro Rico (Ale)",
"tooling": "Claude Code",
"source*of_truth": "Si alguna regla choca con lo que está en el repo, manda lo que esté en el repo y pregunta."
},
"project_context": {
"name": "Bound Next Template",
"goal": "SaaS para automatizar prospección y generación de leads con Agentes AI por vertical. El cliente define su ICP y Bound ejecuta campañas outbound end-to-end.",
"stack": {
"frontend": "Next.js 15 + React 19 + Tailwind v4",
"backend_api": "Next API Routes (Node) por ahora; backend desacoplado según escala",
"db": "Supabase (Auth, Storage, Leads)",
"orchestration": "n8n (scraping, enrichment, emails, seguimiento)",
"integrations": ["Hunter.io", "Firecrawl", "Apollo", "Google Maps", "Perplexity", "Abstract"],
"ai_modules": "Agentes especializados + prompts/datasets por vertical"
},
"monorepo": {
"tool": "pnpm workspaces",
"workspace_globs": ["apps/*", "packages/*"],
"apps": {
"web": "apps/web (Next App Router)",
"api": "apps/api (placeholder)"
},
"packages": {
"ui": "packages/ui (componentes React compartidos)",
"utils": "packages/utils (utilidades SSR/Browser-safe, Vitest ok)",
"types": "packages/types (tipos compartidos)",
"config": "packages/config (tsconfig/eslint/prettier base)"
},
"aliases": { "@/*": "apps/web/src/*" }
},
"tailwind_v4": {
"postcss": "apps/web/postcss.config.mjs",
"config": "apps/web/tailwind.config.ts (incluye ../../packages/ui/src/\**/*.{ts,tsx} en content)",
"globals": "apps/web/src/app/globals.css -> @import \"tailwindcss\"",
"layout": "apps/web/src/app/layout.tsx importa ./globals.css"
},
"routes_base": ["/", "/login", "/onboarding", "/onboarding/success"],
"ci_summary": "GitHub Actions: install --frozen-lockfile → eslint → typecheck → vitest → playwright (chromium)"
},
"engineering_rules": {
"git_flow": {
"protected_branches": ["main", "develop"],
"work_branches": ["feat/*", "fix/*", "chore/*", "docs/*"],
"prs": "Requieren CI verde y al menos 1 review",
"commit_messages": "Conventional Commits en lower-case, p. ej. feat(dashboard): add kpi card",
"note": "El repo HOY sí tiene commitlint en hook; si bloquea, respétalo (lower-case)."
},
"husky_hooks": {
"pre_commit": "lint-staged (ESLint/Prettier sobre staged files). Bloquea si hay errores no corregibles.",
"pre_push": "pnpm typecheck && pnpm --filter @bound/web build. Bloquea si falla."
},
"code_style": {
"typescript": "estricto; evitar any salvo justificado",
"eslint_prettier": "no desactivar reglas sin motivo",
"naming": "archivos/carpetas kebab-case; componentes React PascalCase",
"tailwind": "usar utilidades; @apply solo con criterio",
"a11y": "alt en imágenes, roles/labels correctos, foco visible"
},
"next_react": {
"default": "Server Components",
"use_client": "solo con estado/efectos/eventos/APIs de navegador",
"forbidden_server": ["window", "document", "localStorage", "navigator"],
"routing": "App Router en apps/web/src/app",
"migraciones": {
"next/router": "usar next/navigation",
"imports": "usar alias @/…",
"client_boundaries": "sufijo \*.client.tsx si usa browser APIs"
}
},
"folders_convention": {
"src": {
"app": "Next App Router",
"(routes)": "grupos/rutas",
"api": "route handlers",
"components": "UI compartida",
"features": "módulos (onboarding, campaigns, etc.)",
"lib": "utils puros, sin efectos",
"services": "integraciones (Supabase, n8n, etc.)",
"styles": "globales si aplica"
}
},
"env_secrets": {
"files": [".env.local", ".env.staging", ".env.production"],
"public_prefix": "NEXT_PUBLIC*_",
"secrets_hosting": "GH Actions / Vercel / DO por entorno",
"minimum_staging_vars": [
"NODE_ENV=production",
"NEXT_TELEMETRY_DISABLED=1",
"NEXT_PUBLIC_SUPABASE_URL",
"NEXT_PUBLIC_SUPABASE_ANON_KEY",
"SUPABASE_SERVICE_ROLE_KEY",
"SENTRY_DSN (opcional)",
"APP_BASE_URL"
]
},
"testing": {
"type_safety": "tsc --noEmit en CI",
"unit_vitest": "al menos utils (UUID, formatters)",
"e2e_playwright": "smoke /, /login, /onboarding; headless en CI"
},
"ci_cd": {
"pr_pipeline": "pnpm install --frozen-lockfile → pnpm lint → pnpm typecheck → pnpm build",
"previews": "Vercel por PR o DO App Platform",
"prod": "DO App Platform o Docker multi-stage; healthcheck /api/health"
},
"security": {
"secret_scanning": "habilitado en GitHub",
"headers": "configurar en next.config.ts o proxy",
"logging": "no loguear secretos; rotación periódica"
},
"reviews": {
"pr_scope": "PRs chicos, descripción y checklist",
"reject_if": ["rompe lint", "rompe tipos", "rompe build", "rompe tests"],
"feedback": "comentarios accionables con ejemplo"
}
},
"onboarding_import": {
"source_code": "Preguntar repo/rama/ruta exacta si no se ha dado.",
"target_structure": {
"feature": "apps/web/src/features/onboarding/_",
"pages": [
"apps/web/src/app/onboarding/page.tsx (re-exporta feature)",
"apps/web/src/app/onboarding/success/page.tsx"
]
},
"payload_types": {
"ICP": {
"geo": "string?",
"industries": "string (texto estructurado, no lista)",
"companySize": { "employees": "string?", "locations": "string?", "revenueUSD": "string?" },
"traits": "string?",
"decisionMaker": { "title": "string?", "seniority": "string?" }
},
"WebhookPayload": {
"businessDescription": "string?",
"primaryICP": "ICP?"
}
},
"success_view_requirements": [
"Dos cards: Business e ICP",
"Resiliencia a campos faltantes (renderizar '—')",
"Sin any; tipado explícito"
],
"data_plumbing": {
"strategy_A": "Querystring ?data=<base64/json> para demo rápida",
"strategy_B": "API Route GET /api/onboarding/success?id=... para staging",
"choose": "Usar A si tiempo es clave; B si se apunta a DO."
}
},
"tasks_now": [
"Validar entorno: pnpm install --frozen-lockfile; pnpm typecheck; pnpm exec eslint -c eslint.config.mjs .",
"Enumerar estructura real del repo y confirmar rutas base",
"Confirmar Tailwind operativo (clases visibles en layout/page)",
"Pedir repo/rama/ruta del Onboarding fuente (si falta)",
"Copiar feature onboarding y ajustar imports (@/...) y next/navigation",
"Marcar componentes cliente con \"use client\" cuando usen browser APIs",
"Implementar /onboarding/success con dos cards (Business + ICP) leyendo datos (estrategia A o B)",
"Agregar pruebas smoke E2E de /onboarding y /onboarding/success",
"Abrir PR a develop con descripción de migración y cómo probar"
],
"success_criteria": [
"pnpm typecheck sin errores",
"eslint sin errores bloqueantes",
"apps/web build sin fallos",
"/onboarding y /onboarding/success renderizan con datos (mock o reales)",
"PR con CI verde y checklist de pruebas"
],
"interaction_style": {
"ask_one_question_at_a_time": true,
"be_constructive_critical": true,
"explain_rationale": true,
"state_assumptions": true,
"be_explicit_about_limitations": true
}
}
